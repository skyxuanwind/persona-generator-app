<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2685.1">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="zh-TW"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;title&gt;è‡ªåª’é«”äººè¨­ä¹å®®æ ¼ä¸»é¡Œç”¢ç”Ÿå™¨&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;!-- è¼‰å…¥ Tailwind CSS --&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>tailwind.config = {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>theme: {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>extend: {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>fontFamily: {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>sans: ['Inter', 'Noto Sans TC', 'sans-serif'],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>colors: {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>'primary-blue': '#10b981', // Emerald green/blue</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>'secondary-gray': '#f3f4f6',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>body {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>font-family: 'Inter', 'Noto Sans TC', sans-serif;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>background-color: #f7f9fb;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.grid-item {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>transition: all 0.3s ease;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.grid-item:focus-within {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.5); /* Primary Blue Ring */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/* Custom scrollbar for better look */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>#result-output::-webkit-scrollbar {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>width: 8px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>#result-output::-webkit-scrollbar-track {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>background: #f1f1f1;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>#result-output::-webkit-scrollbar-thumb {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>background: #cbd5e1;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>#result-output::-webkit-scrollbar-thumb:hover {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>background: #94a3b8;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body class="p-4 md:p-8"&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="max-w-4xl mx-auto bg-white shadow-xl rounded-3xl p-6 md:p-10"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;header class="text-center mb-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>è‡ªåª’é«”äººè¨­ä¹å®®æ ¼ï¼šå…§å®¹ä¸»é¡Œç”¢ç”Ÿå™¨</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;p class="text-lg text-gray-500"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>è¼¸å…¥æ‚¨çš„ 9 å¤§æ ¸å¿ƒäººè¨­é—œéµå­—ï¼Œè®“ AI ç­–ç•¥å¸«ç‚ºæ‚¨è¦åŠƒ 5 å€‹æ‹æ”ä¸»é¡Œã€‚</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/header&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;!-- Loading Indicator and API Key Setup --&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div id="loading-indicator" class="hidden fixed inset-0 bg-white bg-opacity-80 flex items-center justify-center z-50 rounded-3xl"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div class="flex flex-col items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-primary-blue mb-4"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p class="text-lg font-medium text-gray-700"&gt;AI ç­–ç•¥å¸«æ­£åœ¨ç™¼æƒ³ä¸­ï¼Œè«‹ç¨å€™...&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;!-- Nine-Grid Input Area --&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;section class="mb-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;h2 class="text-xl font-semibold text-gray-700 mb-4 border-l-4 border-primary-blue pl-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>æ­¥é©Ÿä¸€ï¼šå¡«å¯«æ‚¨çš„ä¹å®®æ ¼äººè¨­</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/h2&gt;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;!-- é—œéµæ”¹å‹•ï¼šåœ¨æ‰‹æ©Ÿä¸Šä½¿ç”¨ grid-cols-1ï¼Œåœ¨ä¸­ç­‰è¢å¹• (md) ä»¥ä¸Šæ‰ä½¿ç”¨ grid-cols-3 --&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="persona-grid" class="grid grid-cols-1 md:grid-cols-3 gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;!-- Data structure: label, placeholder --&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/section&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;!-- Action Button --&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="text-center mb-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;button id="generate-button"<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>class="w-full md:w-auto px-10 py-3 bg-primary-blue text-white font-bold rounded-xl shadow-lg hover:bg-emerald-600 transition duration-200 disabled:opacity-50 flex items-center justify-center"</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>onclick="generateContent()"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;svg id="generate-icon" class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span&gt;ç”¢ç”Ÿ 5 å€‹ä¸»é¡Œå…§å®¹&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;!-- Result Output Area --&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;section&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;h2 class="text-xl font-semibold text-gray-700 mb-4 border-l-4 border-primary-blue pl-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>æ­¥é©ŸäºŒï¼šAI ç­–ç•¥å¸«å»ºè­°çš„ä¸»é¡Œ</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="result-output" class="min-h-[200px] max-h-[600px] overflow-y-auto p-4 bg-secondary-gray border border-gray-200 rounded-xl text-gray-800"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p class="text-gray-500 text-center py-10"&gt;é»æ“Šä¸Šæ–¹çš„æŒ‰éˆ•å¾Œï¼Œå…§å®¹ä¸»é¡Œå°‡æœƒé¡¯ç¤ºåœ¨é€™è£¡ã€‚&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="source-output" class="mt-4 text-sm text-gray-600"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/section&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;script type="module"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// MARK: - API Key &amp; Constants</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const GEMINI_MODEL = "gemini-2.5-flash-preview-05-20";</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// ğŸš¨ å¯†é‘°å·²æ›¿æ›ç‚ºæ‚¨æä¾›çš„æœ€æ–°å¯†é‘°ã€‚</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// é€™æ˜¯æ‡‰ç”¨ç¨‹å¼åœ¨å¤–éƒ¨ç¶²è·¯é‹è¡Œçš„é—œéµã€‚</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>let apiKey = "AIzaSyBw21-KXVMwXG3UtoGVVBoqODhlDXo5oSg";<span class="Apple-converted-space">Â </span></p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/${GEMINI_MODEL}:generateContent?key=${apiKey}`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const MAX_RETRIES = 5;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// The 9 fields for the persona grid (æˆ¿ä»²/å€‹äººäººè¨­ç°¡åŒ–ç‰ˆ)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const personaFields = [</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>{ id: 'identity', label: '1. æˆ‘æ˜¯èª°/è§’è‰²å®šä½ (Center)', placeholder: 'ä¾‹å¦‚ï¼šå°åŒ—ä¿¡ç¾©å€æˆ¿ä»²ã€è£ä¿®å°ˆå®¶' },</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>{ id: 'expertise', label: '2. å°ˆé•·/ä¸»è¦é ˜åŸŸ (Skill)', placeholder: 'ä¾‹å¦‚ï¼šè€å±‹ç¿»æ–°ã€å¥—æˆ¿è²·è³£' },</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>{ id: 'audience', label: '3. æƒ³å¹«åŠ©èª°/å®¢ç¾¤ (Audience)', placeholder: 'ä¾‹å¦‚ï¼šé¦–æ¬¡è³¼å±‹çš„å¹´è¼•æƒ…ä¾¶' },</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>{ id: 'pain-point', label: '4. ä»–å€‘ç…©æƒ±ä»€éº¼ (Pain Point)', placeholder: 'ä¾‹å¦‚ï¼šé ç®—æœ‰é™ï¼Œåˆæƒ³æ‰¾åœ°é»å¥½çš„æˆ¿å­' },</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>{ id: 'solution', label: '5. æˆ‘çš„æ ¸å¿ƒåƒ¹å€¼ (Value)', placeholder: 'ä¾‹å¦‚ï¼šèª ä¿¡æ­£ç›´ã€æä¾›å¸‚å ´æ·±åº¦åˆ†æ' },</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>{ id: 'interest', label: '6. æˆ‘çš„æ¥­é¤˜èˆˆè¶£ (Interest)', placeholder: 'ä¾‹å¦‚ï¼šå¥èº«ã€å¯µç‰©ã€å’–å•¡' },</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>{ id: 'trait', label: '7. æˆ‘çš„èªªè©±é¢¨æ ¼ (Style)', placeholder: 'ä¾‹å¦‚ï¼šå¹½é»˜é¢¨è¶£ã€è¦ªåˆ‡æœ‰è€å¿ƒ' },</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>{ id: 'slogan', label: '8. æˆ‘çš„é‡‘å¥/å£é ­ç¦ª (Slogan)', placeholder: 'ä¾‹å¦‚ï¼šè²·æˆ¿ï¼Œå°±æ˜¯è²·æœªä¾†ï¼' },</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>{ id: 'difference', label: '9. æˆ‘èˆ‡çœ¾ä¸åŒä¹‹è™• (Difference)', placeholder: 'ä¾‹å¦‚ï¼šæœ‰ 10 å¹´è³‡ç”¢é…ç½®ç¶“é©—çš„æˆ¿ä»²' },</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// MARK: - DOM Elements</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const personaGrid = document.getElementById('persona-grid');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const generateButton = document.getElementById('generate-button');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const resultOutput = document.getElementById('result-output');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const sourceOutput = document.getElementById('source-output');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const loadingIndicator = document.getElementById('loading-indicator');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// MARK: - Initial Grid Rendering</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>function renderGrid() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>personaGrid.innerHTML = personaFields.map(field =&gt; `</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="grid-item bg-white p-3 rounded-xl border border-gray-300 shadow-sm hover:border-primary-blue/50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;label for="${field.id}" class="block text-sm font-medium text-gray-700 mb-1"&gt;${field.label}&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;input type="text" id="${field.id}" placeholder="${field.placeholder}"<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>class="mt-1 block w-full border-0 p-0 text-base text-gray-900 focus:ring-0 focus:outline-none placeholder-gray-400"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>`).join('');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>window.onload = renderGrid;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// MARK: - Theme Parsing Function</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/**</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* Parses the Markdown list output into an array of structured theme objects.</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>*/</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>function parseThemes(markdownText) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const themes = [];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// Clean up text and split by numbered list item markers</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const themeBlocks = markdownText.split(/(\n\s*\d+\.\s*)/g).filter(block =&gt; block.trim() !== '' &amp;&amp; !/^\d+\.$/.test(block.trim()));</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>themeBlocks.forEach((block, index) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>block = block.trim();</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// Regex to capture: **Title**: Description (or Title: Description)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const match = block.match(/^\s*\*\*(.*?)\*\*[:ï¼š]?\s*(.*)/s);</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>let title = `ä¸»é¡Œ ${index + 1} æ¨™é¡Œ (ç„¡æ³•è§£æ)`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>let core = 'ç„¡æ³•è§£æå…§å®¹æ ¸å¿ƒã€‚';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (match) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Successful capture</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>title = match[1].trim() || `ä¸»é¡Œ ${index + 1} æ¨™é¡Œ`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>core = match[2].trim() || 'ç„¡å…§å®¹æ ¸å¿ƒèªªæ˜ã€‚';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Fallback for non-bolded or slightly different format</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const parts = block.split(/[:ï¼š]/, 2);</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (parts.length === 2) {</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>title = parts[0].replace(/\*\*/g, '').trim();<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>core = parts[1].trim();</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Last resort: take the first line as title</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>title = block.split('\n')[0].replace(/\*\*/g, '').trim();</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>core = block.substring(title.length).trim();</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (core.startsWith(':') || core.startsWith('ï¼š')) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>core = core.substring(1).trim();</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>themes.push({ title, core });</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>return themes;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// MARK: - AI Content Generation Logic</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/**</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* Utility function to handle API retries with exponential backoff.</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>*/</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>async function retryWithExponentialBackoff(fetcher, maxRetries) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>for (let i = 0; i &lt; maxRetries; i++) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>try {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const response = await fetcher();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (response.ok) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>return response;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// é‡åˆ° 401 éŒ¯èª¤æ™‚ï¼Œé¡¯ç¤ºæ›´æ¸…æ™°çš„æç¤ºä¸¦åœæ­¢é‡è©¦</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (response.status === 401) {</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>resultOutput.innerHTML = `&lt;p class="text-red-500 text-center py-10"&gt;ğŸš¨ API é©—è­‰éŒ¯èª¤ (401)ã€‚&lt;br&gt;è«‹ç¢ºèªç¨‹å¼ç¢¼ä¸­çš„ **apiKey** æ˜¯å¦ç‚ºæœ‰æ•ˆçš„ Gemini å¯†é‘°ã€‚&lt;/p&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>throw new Error(`API call failed with status 401: API Key configuration error.`);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Handle specific error codes if needed, e.g., 429 Rate Limit</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (response.status === 429 || response.status &gt;= 500) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>console.warn(`API call failed (Status: ${response.status}). Retrying in ${delay}ms... (Attempt ${i + 1}/${maxRetries})`);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>await new Promise(resolve =&gt; setTimeout(resolve, delay));</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>continue;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// For other non-retryable errors (e.g., 400), throw immediately</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>throw new Error(`API call failed with status ${response.status}: ${response.statusText}`);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (i === maxRetries - 1) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>console.error("API call failed after all retries.", error);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>throw error;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// For network errors, we retry</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>console.warn(`Network error. Retrying in ${delay}ms... (Attempt ${i + 1}/${maxRetries})`);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>await new Promise(resolve =&gt; setTimeout(resolve, delay));</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/**</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* Main function to generate content using the Gemini API.</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>*/</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>window.generateContent = async function() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>generateButton.disabled = true;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>loadingIndicator.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>resultOutput.innerHTML = `&lt;p class="text-gray-500 text-center py-10"&gt;AI ç­–ç•¥å¸«æ­£åœ¨ç™¼æƒ³ä¸­...&lt;/p&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>sourceOutput.innerHTML = '';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const inputs = personaFields.map(field =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const element = document.getElementById(field.id);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>return `${field.label.split(' ')[0]}: ${element ? element.value.trim() : 'ç„¡è¼¸å…¥'}`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}).join('\n');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (!inputs.trim()) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>resultOutput.innerHTML = `&lt;p class="text-red-500 text-center py-10"&gt;è«‹è‡³å°‘å¡«å¯«ä¸€å€‹ä¹å®®æ ¼é …ç›®ï¼&lt;/p&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>generateButton.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>loadingIndicator.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// ç¢ºä¿æ¨¡å‹è¼¸å‡ºæ ¼å¼ç‚ºæ˜“æ–¼è§£æçš„åˆ—è¡¨</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const systemPrompt = "ä½ æ˜¯ä¸€ä½é ‚å°–çš„è‡ªåª’é«”å…§å®¹ç­–ç•¥å¸«ã€‚è«‹æ ¹æ“šæä¾›çš„ä¹å®®æ ¼äººè¨­è³‡è¨Šï¼Œç™¼æƒ³5å€‹å…·é«”ã€å¼•äººå…¥å‹ä¸”èˆ‡æ™‚ä¿±é€²çš„å½±ç‰‡æˆ–æ–‡ç« ä¸»é¡Œã€‚è«‹ä½¿ç”¨åš´æ ¼çš„æ ¼å¼è¼¸å‡ºï¼šæ¯å€‹ä¸»é¡Œå¿…é ˆæ˜¯ç¨ç«‹çš„ç·¨è™Ÿåˆ—è¡¨é … (1. 2. 3...)ï¼Œä¸”æ ¼å¼ç‚ºï¼š**[å¸å¼•äººçš„æ¨™é¡Œ]**ï¼š[ç°¡çŸ­çš„å…§å®¹æ ¸å¿ƒèªªæ˜]ã€‚è«‹å‹¿æ·»åŠ ä»»ä½•å…¶ä»–å‰è¨€ã€å¾Œè¨˜æˆ–é¡å¤–è§£é‡‹ã€‚";</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const userQuery = `æˆ‘çš„è‡ªåª’é«”ä¹å®®æ ¼äººè¨­è¨­å®šå¦‚ä¸‹ï¼š\n\n${inputs}\n\nè«‹ç‚ºæˆ‘ç”¢ç”Ÿ5å€‹æ‹æ”ä¸»é¡Œå…§å®¹ã€‚`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const payload = {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>contents: [{ parts: [{ text: userQuery }] }],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// å•Ÿç”¨ Google Search Groundingï¼Œç¢ºä¿ä¸»é¡Œèˆ‡æ™‚ä¿±é€²</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>tools: [{ "google_search": {} }],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>systemInstruction: {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>parts: [{ text: systemPrompt }]</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>try {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const fetcher = () =&gt; fetch(API_URL, {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>method: 'POST',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>headers: { 'Content-Type': 'application/json' },</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>body: JSON.stringify(payload)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const response = await retryWithExponentialBackoff(fetcher, MAX_RETRIES);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const result = await response.json();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const candidate = result.candidates?.[0];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (candidate &amp;&amp; candidate.content?.parts?.[0]?.text) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const text = candidate.content.parts[0].text;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const themes = parseThemes(text);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>let themesHtml = '';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (themes.length &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// 1. Display generated text in clean card format</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>themesHtml = themes.map((theme, index) =&gt; `</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="bg-white p-5 rounded-xl shadow-lg border-l-4 border-primary-blue/70 mb-4 transition duration-300 hover:shadow-xl"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="flex items-start mb-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span class="text-xl font-extrabold text-primary-blue bg-primary-blue/10 rounded-full h-8 w-8 flex items-center justify-center mr-3 flex-shrink-0"&gt;${index + 1}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;h3 class="text-lg font-bold text-gray-800 pt-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>ä¸»é¡Œæ¨™é¡Œ: &lt;span class="text-primary-blue"&gt;${theme.title}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p class="text-sm text-gray-600 pl-11"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span class="font-semibold text-gray-700"&gt;å…§å®¹æ ¸å¿ƒ:&lt;/span&gt; ${theme.core}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>`).join('');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>resultOutput.innerHTML = themesHtml;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Fallback for non-parsed or strange output</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>resultOutput.innerHTML = `&lt;p class="text-red-500 text-center py-5"&gt;ç„¡æ³•ä»¥ç°¡æ½”æ ¼å¼è§£æ AI ç”¢å‡ºçš„ä¸»é¡Œã€‚ä»¥ä¸‹æ˜¯åŸå§‹è¼¸å‡ºå…§å®¹ï¼š&lt;/p&gt;&lt;div class="p-4 border border-gray-300 rounded-lg whitespace-pre-wrap text-sm text-gray-700"&gt;${text}&lt;/div&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// 2. Extract and display grounding sources (citations)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>let sources = [];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const groundingMetadata = candidate.groundingMetadata;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (groundingMetadata &amp;&amp; groundingMetadata.groundingAttributions) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>sources = groundingMetadata.groundingAttributions</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>.map(attribution =&gt; ({</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>uri: attribution.web?.uri,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>title: attribution.web?.title,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}))</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>.filter(source =&gt; source.uri &amp;&amp; source.title);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (sources.length &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const sourceList = sources.map((s, index) =&gt;<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>`&lt;a href="${s.uri}" target="_blank" class="text-primary-blue hover:underline block truncate"&gt;${index + 1}. ${s.title}&lt;/a&gt;`</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>).join('');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>sourceOutput.innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p class="font-medium"&gt;åƒè€ƒä¾†æº (AI ç¢ºä¿å…§å®¹èˆ‡æ™‚ä¿±é€²):&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="mt-1 space-y-1"&gt;${sourceList}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>sourceOutput.innerHTML = `&lt;p class="text-gray-500"&gt;æ­¤å…§å®¹ç‚ºç´”AIç”Ÿæˆï¼Œç„¡å³æ™‚ç¶²è·¯è³‡è¨Šåƒè€ƒã€‚&lt;/p&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>resultOutput.innerHTML = `&lt;p class="text-red-500 text-center py-10"&gt;æŠ±æ­‰ï¼ŒAI å…§å®¹ç­–ç•¥å¸«æœªèƒ½ç”¢ç”Ÿä¸»é¡Œã€‚è«‹æª¢æŸ¥æ‚¨çš„è¼¸å…¥ä¸¦å†è©¦ä¸€æ¬¡ã€‚&lt;/p&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>console.error("Gemini response was missing text content.", result);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>console.error("Content generation failed:", error);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// æª¢æŸ¥æ˜¯å¦æ˜¯ 401 éŒ¯èª¤ï¼Œå¦‚æœæ˜¯å‰‡ä¸è¦†è“‹éŒ¯èª¤è¨Šæ¯ï¼Œä»¥é¡¯ç¤ºè‡ªè¨‚æç¤º</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (error.message.includes("401")) return;<span class="Apple-converted-space">Â </span></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>resultOutput.innerHTML = `&lt;p class="text-red-500 text-center py-10"&gt;é€£ç·šéŒ¯èª¤ï¼šç„¡æ³•èˆ‡ AI ä¼ºæœå™¨å»ºç«‹é€£ç·šï¼Œè«‹ç¨å¾Œå†è©¦ã€‚ (${error.message})&lt;/p&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>} finally {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>generateButton.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>loadingIndicator.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
